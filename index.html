<!DOCTYPE html>
<html lang="ht">
<head>
    <!-- ... (menm style ak head ansyen an) -->
</head>
<body>

    <h1>ğŸ”¥ AI Dashboard Final + TTS</h1>

    <!-- ... (kenbe card license ak bouton agree si li toujou la) -->

    <div class="card">
        <h3>ğŸ“· Analize Imaj</h3>
        <input type="file" id="imgInput" accept="image/*">
        <button id="btnImg">Analize Imaj</button>
        <pre id="resImg">Atann rezilta...</pre>
        <button onclick="speakResult('resImg', 'en')">ğŸ”Š Li Deskripsyon an awot vwa (AnglÃ¨)</button>
    </div>

    <div class="card">
        <h3>ğŸ™ï¸ Transkri Vwa (Audio to Text)</h3>
        <!-- ... (kenbe kontwÃ²l enregistre ak upload) -->
        <pre id="resAudio">Atann rezilta...</pre>
        <button onclick="speakResult('resAudio', 'fr')">ğŸ”Š Li Transkripsyon an awot vwa (FransÃ¨ - pi bon pou KreyÃ²l)</button>
    </div>

    <div class="card">
        <h3>ğŸ”Š TÃ¨ks a Vwa (Text to Speech)</h3>
        <textarea id="ttsText" rows="5" placeholder="Ecri tÃ¨ks ou vle tande awot vwa (max 1000 karaktÃ¨)"></textarea>
        <select id="ttsLang">
            <option value="en">AnglÃ¨</option>
            <option value="fr" selected>FransÃ¨ (rekomande pou KreyÃ²l)</option>
        </select>
        <button id="ttsBtn">Jenere epi Jwe Vwa</button>
        <audio id="ttsAudio" controls style="width:100%; margin-top:10px;"></audio>
    </div>

    <script>
        const BASE_URL = "https://teste.adamdh7.org";

        // ... (kenbe tout fonksyon ansyen yo: agree, enregistre, processAudio, processImage)

        // NOUVO: Fonksyon pou Text to Speech
        async function processTTS(text, lang = "en") {
            const audioPlayer = document.getElementById('ttsAudio');
            audioPlayer.src = ''; // Reset

            try {
                const response = await fetch(`${BASE_URL}/text-to-speech`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ text, lang })
                });

                if (!response.ok) {
                    const err = await response.json();
                    throw new Error(err.error || 'ErÃ¨ sÃ¨vÃ¨');
                }

                const blob = await response.blob();
                const url = URL.createObjectURL(blob);
                audioPlayer.src = url;
                audioPlayer.play();
            } catch (err) {
                alert("ErÃ¨ TTS: " + err.message);
            }
        }

        // Bouton prensipal TTS
        document.getElementById('ttsBtn').onclick = () => {
            const text = document.getElementById('ttsText').value.trim();
            const lang = document.getElementById('ttsLang').value;
            if (!text) return alert("Ecri yon tÃ¨ks anvan!");
            processTTS(text, lang);
        };

        // Fonksyon pou li rezilta yo otomatikman
        function speakResult(resId, lang) {
            const text = document.getElementById(resId).innerText.trim();
            if (!text || text.includes("Atann") || text.includes("ErÃ¨")) return alert("Pa gen bon rezilta pou li!");
            processTTS(text, lang);
        }

        // ... (rÃ¨s script ansyen an)
    </script>
</body>
</html>
